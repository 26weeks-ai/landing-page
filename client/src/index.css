@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: dark;

  /* Noir editorial (dark-only) — aligned with `design/tokens/figma_tokens.json`. */
  --background: 203 22.2% 7.1%; /* gunmetal.800 / ink #0E1316 */
  --foreground: 44 86.7% 94.1%; /* ivory.50 #FDF6E3 */

  --card: 213 20% 8.8%; /* surface #12161B */
  --card-foreground: 44 86.7% 94.1%;

  --popover: 213 20% 10.8%; /* surfaceElevated #161B21 */
  --popover-foreground: 44 86.7% 94.1%;

  --muted: 213 20% 10.8%;
  --muted-foreground: 35 13.6% 75.5%; /* lightSilver #C9C2B8 */

  --border: 214 17.4% 18%; /* hairline #262D36 */
  --input: 214 17.4% 18%;

  /* Primary action fill = copper.700 (hover/pressed are handled at component level). */
  --primary: 23 54.1% 35.9%; /* copper.700 #8D502A */
  --primary-foreground: 44 86.7% 94.1%; /* onPrimary #FDF6E3 */

  /* Secondary action fill = midnightGreen.600. */
  --secondary: 185 84.9% 18.2%; /* midnightGreen.600 #075056 */
  --secondary-foreground: 44 86.7% 94.1%; /* ivory.50 */

  /* Accent surfaces (hover backgrounds, subtle fills). */
  --accent: 213 20% 10.8%;
  --accent-foreground: 44 86.7% 94.1%;

  --destructive: 0 63.9% 55.5%; /* error #D64545 */
  --destructive-foreground: 44 86.7% 94.1%;

  /* Focus + links = copper.500. */
  --ring: 24 49.8% 50.8%; /* copper.500 #C07543 */

  /* Charts (dark). */
  --chart-1: 24 49.8% 50.8%; /* copper.500 */
  --chart-2: 44 84.5% 72.2%; /* sandYellow.500 #F4D47C */
  --chart-3: 173 41.5% 49.6%; /* #4AB3A6 */
  --chart-4: 204 63.8% 72.9%; /* #8EC3E6 */
  --chart-5: 35 13.6% 75.5%; /* lightSilver */

  /* Sidebar (kept for shadcn components; mapped to noir). */
  --sidebar-background: 213 20% 8.8%;
  --sidebar-foreground: 44 86.7% 94.1%;
  --sidebar-primary: 23 54.1% 35.9%;
  --sidebar-primary-foreground: 44 86.7% 94.1%;
  --sidebar-accent: 213 20% 10.8%;
  --sidebar-accent-foreground: 44 86.7% 94.1%;
  --sidebar-border: 214 17.4% 18%;
  --sidebar-ring: 24 49.8% 50.8%;

  /* Brand scales (subset) — for direct Tailwind usage without hard-coded hex. */
  --copper-50: 26 100% 95.9%;
  --copper-100: 23 100% 92%;
  --copper-200: 25 81.4% 81%;
  --copper-300: 27 71.6% 66.9%;
  --copper-400: 25 60% 56.9%;
  --copper-500: 24 49.8% 50.8%;
  --copper-600: 24 51.4% 43.5%;
  --copper-700: 23 54.1% 35.9%;
  --copper-800: 23 55.9% 28.4%;
  --copper-900: 22 56.5% 22.5%;

  --midnight-50: 187 19% 91.8%;
  --midnight-100: 186 26.6% 84.5%;
  --midnight-200: 185 26.8% 72.2%;
  --midnight-300: 183 25.2% 59.6%;
  --midnight-400: 183 26.2% 47.8%;
  --midnight-500: 183 37.9% 37.3%;
  --midnight-600: 185 84.9% 18.2%;
  --midnight-700: 185 83.8% 14.5%;
  --midnight-800: 183 88% 9.8%;
  --midnight-900: 184 94.1% 6.7%;

  --sand-500: 44 84.5% 72.2%;

  --paper: 44 86.7% 94.1%;
  --paper-secondary: 35 13.6% 75.5%;
  --paper-muted: 40 5% 53.3%;

  --radius: 0.75rem;
}

.dark {
  color-scheme: dark;
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
  }

  /* Improve accessibility and performance */
  :focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .text-neutral-600 {
      @apply text-neutral-800;
    }
    .text-neutral-400 {
      @apply text-neutral-700;
    }
  }

  /* Reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }

    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

@keyframes hero-route-float {
  0%,
  100% {
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
  50% {
    transform: translate3d(var(--float-x, 14px), var(--float-y, -12px), 0)
      rotate(var(--float-rotate, 0deg));
  }
}

@keyframes hero-route-comet {
  from {
    stroke-dashoffset: 0;
  }
  to {
    stroke-dashoffset: -1000;
  }
}

@layer utilities {
  .hero-routes-backdrop {
    contain: layout paint;
    --route-size: 280px;
  }

  .hero-route {
    position: relative;
    height: 100%;
    width: 100%;
    color: hsl(var(--copper-300) / 0.56);
    mix-blend-mode: lighten;
  }

  .hero-route-cell {
    position: absolute;
    height: var(--route-size);
    width: var(--route-size);
    transform-origin: center;
    will-change: transform;
  }

  .hero-route__transform {
    position: absolute;
    inset: 0;
    display: grid;
    place-items: center;
    transform: rotate(var(--route-rotate, 0deg)) scale(var(--route-scale, 0.9));
    transform-origin: center;
    will-change: transform;
  }

  .hero-route__float {
    position: relative;
    height: 100%;
    width: 100%;
    animation: hero-route-float var(--float-duration, 18s) ease-in-out infinite;
    animation-delay: var(--float-delay, 0s);
    will-change: transform;
  }

  .hero-route__svg {
    display: block;
    height: 100%;
    width: 100%;
  }

  .hero-route__path {
    fill: none;
    stroke-linecap: round;
    stroke-linejoin: round;
    vector-effect: non-scaling-stroke;
  }

  .hero-route__path--base {
    stroke: currentColor;
    stroke-width: 3.85;
    stroke-opacity: var(--route-opacity, 0.14);
    filter: blur(var(--route-blur, 0px))
      drop-shadow(0 0 0.55rem hsl(var(--copper-700) / 0.05))
      drop-shadow(0 0 2rem hsl(var(--midnight-900) / 0.22));
  }

  .hero-route__glint {
    stroke-dashoffset: 0;
    animation: hero-route-comet var(--glint-duration, 18s) linear infinite;
    animation-delay: var(--glint-delay, 0s);
    will-change: stroke-dashoffset;
    mix-blend-mode: screen;
  }

  .hero-route__glint--tail {
    stroke: hsl(var(--copper-500) / 0.22);
    stroke-width: 4.25;
    stroke-opacity: 1;
    stroke-dasharray: 0 984 14 2;
    filter: blur(0.7px) drop-shadow(0 0 0.65rem hsl(var(--copper-500) / 0.2))
      drop-shadow(0 0 1.65rem hsl(var(--copper-500) / 0.08));
  }

  .hero-route__glint--head {
    stroke: hsl(var(--copper-500) / 0.92);
    stroke-width: 4.8;
    stroke-opacity: 1;
    stroke-dasharray: 0 998.6 1.4 0;
    filter: drop-shadow(0 0 0.7rem hsl(var(--copper-500) / 0.36))
      drop-shadow(0 0 1.85rem hsl(var(--copper-500) / 0.12));
  }

  [data-hero-hovered="true"] .hero-route__path--base {
    stroke-opacity: var(--route-opacity-hot, 0.24);
    filter: blur(0px) drop-shadow(0 0 0.8rem hsl(var(--copper-700) / 0.07))
      drop-shadow(0 0 3.1rem hsl(var(--copper-500) / 0.08));
  }
}
